document.addEventListener('DOMContentLoaded', loadMalwares);

const malwareForm = document.getElementById('malwareForm');
const malwareList = document.getElementById('malwareList');

malwareForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const name = document.getElementById('name').value;
    const description = document.getElementById('description').value;

    await fetch('http://localhost:3000/api/malware', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, description })
    });
    malwareForm.reset();
    loadMalwares();
});

async function loadMalwares() {
    const response = await fetch('/api/malware');
    const malwares = await response.json();
    malwareList.innerHTML = '';

    malwares.forEach(malware => {
        const item = document.createElement('li');
        item.className = 'malware-item';
        item.innerHTML = `
            <strong>${malware.name}</strong><br>
            ${malware.description}<br>
            <button onclick="deleteMalware(${malware.id})">Excluir</button>
        `;
        malwareList.appendChild(item);
    });
}

async function deleteMalware(id) {
    await fetch(`/api/malware/${id}`, { method: 'DELETE' });
    loadMalwares();
}
